# 精投前端

## 一、WdatePicker时间控件初始化

```html
<div class="inputDiv">
	<input type="text" style="height: 25px;width: 60px;float:none;border: 1px solid  #00BBFF !important;" class="Wdate" id="year" />
</div>
```

有两个不同路径的**WdatePicker.js**，内部分别引入同路径下的**skin/WdatePicker.css**，会在css最后引入，所以自定义css中修改是不会生效。

```html
<!-- 代表蓝色背景 -->
<script src="../../../plugins/datePicker/My97DatePicker/WdatePicker.js" type="text/javascript"></script>

<!-- 代表默认白色背景 -->
<script src="../../../plugins/My97DatePicker/WdatePicker.js" type="text/javascript"></script>
```

```javascript
var initControls = function(){
    //初始化年份控件
	$('#year').click(function(){
			WdatePicker({
				dateFmt:'yyyy',isShowToday:false
		    })
    });
    $('#year').val(new Date().getFullYear() - 1);
    //获取值
    $('#year').val();
}
```



## 二、HTML5嵌入自定义数据

```html
<div id="one" data-flag="1"></div>
<div id="two" data-flag="2"></div>
```

```js
//data()属于jQuery，需要将对象转为jQuery。比如:$(this)
$("#one").data("flag");
$("#two").data("flag")
```



## 三、width:0作用

```html
<div style="background-color: red; border: 10px blue solid; width: 200px; height: 100px; margin:20px; padding:40px">
    郭天航
</div>
```

<div style="background-color: red; border: 10px blue solid; width: 200px; height: 100px; margin:20px; padding:40px; margin:0 auto; text-align:center">
    郭天航
</div>
<img src="精投项目--总结_img/123.bmp" style="zoom:80%;" />

该div的宽度 = 200px + 40px *2 + 10px *2 +20px *2

**width:0 ：文本域宽度为0 ；可以设置border绘制图形。**

## 四、calc()注意

```html
width: calc(100% - 10px);
```

<span style="color: red; font-size: 15px">注意：运算符前后加空格，否则不生效。</span>

## 五、Unicode符号

 ' &times';代表 &times; 

## 六、操作表格

```html
<div style="width: 100%;height: calc(100% - 35px);">
	<table id="wsi_tableGrid" style="width: 100%;height: 100%;"></table>
</div>
```

### 6.1 获取表头数据

```javascript
// ajaxPath:ajax请求根路径   repId: 左侧树对应Id
var finaltitle = mCommon.getTitle(ajaxPath, repId);
// 表格左侧固定列表头
var leftcols= finaltitle.leftcols;
// 表格右侧数据表头
var rightcols= finaltitle.rightcols;

```

### 6.2 单独设置列属性

数据库中设置FORMATTER = '。remarkFormatter。'，其中的remarkFormatter是自己写的方法，当渲染数据时会通过该方法对该列进行重构，包括为某列添加背景色等。

```javascript
//value代表值、row代表该行的数据、index代表下标索引
function fileFormatter(value,row,index){
  return `<span class="item-detail">文件</span>`;
};
```

### 6.3单击单元格触发

```javascript
onClickCell: function(rowIndex, field, value){
}
```

### 6.4结束编辑触发

```javascript
onAfterEdit:function(index,row,changes){
}
```

### 6.5设置行样式(汇总行颜色)

```javascript
rowStyler: function(index, row) {
    style = "";
    // 若行存在且有bgcolor属性 则赋予行颜色（用于合计行）
    if (row && row.bgcolor) {
        style += 'background-color:'+row.bgcolor+' !important;';
    }
    if (row && row.bold == '1') {
        style += 'font-weight:bold !important;';
    }
    return style;
}
```

### 6.6 获取选中行的数据

```javascript
var rows = $itemGrid.datagrid('getChecked');
var rowsSelections = $reportGrid.datagrid('getSelections');
```

### 6.7为表格赋值

```javascript
//表格id  compJson需要的为json数据
$("#compCapitalGrid").datagrid('loadData',compJson);
```

### 6.8表格添加多选框

```javascript
//设置第一列为选择框时
leftcols[0].unshift({field:'ck',width:'60',checkbox:true});
```

## 七、下拉框

```javascript
<div class="inputDiv">
	<label>状态</label> <input id="wsi_state" size="18" style="width: 120px;">	
</div>
```

```javascript
$state.combobox({
    data:global.stateList,
    valueField: 'id',
    textField: 'text',
    multiple:false,//是否支持多选
    editable:false,
    panelWidth: 120,//下拉数据所占宽度
    panelHeight: 'auto'
}).combobox('setValue',global.stateList[0].id);
```

## 八、 加载界面

### 8.1 load()：将指定页面 *片段* 加载到当前页面，（需要注意片段中图片对应的src地址，不一致不会显示）

```javascript
$('#loadZhSearchNew').load('./investimplement/zhsearch/zhsearchNew.html #zhsearchNewDiv',function(){
    mTagModel.Search(itemcode);
});
```

### 8.2  window.location.href 加载整个页面，包括html中引入的css和js

```javascript
window.location.href = "../../html/processtracking/processtracking.html?200";	//跳转后的地址通过window.location.href获取后面参数

//当页面中存在iframe标签，会在iframe窗口打开url地址
<div id="mainIframe">
    <iframe id="mainPage" name="mainPage" src="" width="100%" height="100%" frameborder="0"></iframe>
</div>

//没有iframe标签，当前页面会跳转到url地址
```

### 8.3 $("#mainPage").attr("src",path); 加载整个页面，包括html中引入的css和js

```javascript
//指定iframe显示文档
<div id="mainIframe">
    <iframe id="mainPage" name="mainPage" src="" width="100%" height="100%" frameborder="0"></iframe>
</div>
```



## 九、ajaxFileUpload插件的change问题

通过ajaxFileUpload上传 input[type=file] 文件后，input[type=file]绑定的change事件会失效：

​	原因：ajaxFileUpload会把原来的file元素替换成新的file元素，所以之前绑定的change事件就失效了。

​	解决：再上传成功success后重新绑定change事件，**不能通过id绑定**。

```javascript
$("input[type=file]").bind('change' ,function() {
	//
});
```

## 十、内容隐藏，显示：供电区...

```css
	white-space: nowrap;	//不换行
	text-overflow: ellipsis;	//文本溢出时以...形式展示
	overflow:hidden;
```

## 十一、onerror函数

```javascript
window.onerror = () => {alert("错错错~~~")}	

var num;
num.length();	//会触发onerror函数
```

## 十二、span等标签可编辑

```javascript
<span contenteditable="true">昵称</span>

<style>
[contenteditable]:focus{outline: none; border:	border: 1px solid #d0d0d0;}
</style>
```

## 十二、多个数组合并：flat()